<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Photo Enhancer</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing:border-box; margin:0; padding:0; font-family:'Montserrat',sans-serif; }
    body { background: linear-gradient(135deg,#f6d365,#fda085); min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; padding:50px 20px; color:#333; }
    h1 { font-size:3rem; margin-bottom:10px; text-align:center; color:#fff; text-shadow:2px2px5px rgba(0,0,0,0.3);}
    p { text-align:center; margin-bottom:40px; font-size:1.2rem; color:#fff; text-shadow:1px1px3px rgba(0,0,0,0.3); }

    .upload-section { display:flex; flex-direction:column; align-items:center; background:rgba(255,255,255,0.9); padding:30px; border-radius:20px; box-shadow:0 10px 25px rgba(0,0,0,0.2); max-width:400px; width:100%; }
    input[type="file"] { padding:10px; border-radius:10px; border:1px solid #ccc; margin-bottom:20px; width:100%; cursor:pointer; }
    .slider-group { width:100%; margin-bottom:15px; }
    label { display:flex; justify-content:space-between; margin-bottom:5px; }
    input[type="range"] { width:100%; }
    button { background:#ff7e5f; color:white; border:none; padding:15px 30px; font-size:1rem; font-weight:bold; border-radius:50px; cursor:pointer; transition:all 0.3s ease; box-shadow:0 5px 15px rgba(0,0,0,0.2); margin-top:10px; }
    button:hover { background:#feb47b; transform:translateY(-3px); box-shadow:0 8px 20px rgba(0,0,0,0.3); }
    .images { display:flex; flex-direction:column; align-items:center; margin-top:40px; gap:20px; width:100%; }
    .images img { max-width:300px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.2); transition: transform 0.3s ease; }
    .images img:hover { transform: scale(1.05); }
    .loader { border:6px solid #f3f3f3; border-top:6px solid #ff7e5f; border-radius:50%; width:50px; height:50px; animation:spin 1s linear infinite; margin-top:20px; display:none; }
    @keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }
    @media(max-width:500px){ h1{font-size:2.2rem;} p{font-size:1rem;} button{width:100%;} }
  </style>
</head>
<body>

<h1>✨ AI Photo Enhancer ✨</h1>
<p>Adjust settings to enhance your photo the way you like.</p>

<div class="upload-section">
  <input type="file" id="imageInput" accept="image/*">

  <div class="slider-group">
    <label>Smoothness: <span id="smoothVal">0.5</span></label>
    <input type="range" id="smooth" min="0" max="1" step="0.05" value="0.5">
  </div>
  <div class="slider-group">
    <label>Brightness: <span id="brightVal">0</span></label>
    <input type="range" id="brightness" min="-1" max="1" step="0.05" value="0">
  </div>
  <div class="slider-group">
    <label>Contrast: <span id="contrastVal">0</span></label>
    <input type="range" id="contrast" min="-1" max="1" step="0.05" value="0">
  </div>

  <button id="enhanceBtn" onclick="uploadImage()">Enhance My Photo</button>
  <div class="loader" id="loader"></div>

  <div class="images">
    <img id="original" alt="Original Photo" style="display:none;">
    <img id="enhanced" alt="Enhanced Photo" style="display:none;">
  </div>
</div>

<script>
const smoothSlider = document.getElementById("smooth");
const brightnessSlider = document.getElementById("brightness");
const contrastSlider = document.getElementById("contrast");

smoothSlider.addEventListener("input", ()=>document.getElementById("smoothVal").textContent=smoothSlider.value);
brightnessSlider.addEventListener("input", ()=>document.getElementById("brightVal").textContent=brightnessSlider.value);
contrastSlider.addEventListener("input", ()=>document.getElementById("contrastVal").textContent=contrastSlider.value);

async function uploadImage() {
  const file = document.getElementById("imageInput").files[0];
  if(!file) return alert("Please select an image!");

  const loader = document.getElementById("loader");
  const btn = document.getElementById("enhanceBtn");
  const original = document.getElementById("original");
  const enhanced = document.getElementById("enhanced");

  loader.style.display="block"; btn.disabled=true;
  original.style.display="none"; enhanced.style.display="none";

  const reader = new FileReader();
  reader.onload = ()=>{ original.src=reader.result; original.style.display="block"; };
  reader.readAsDataURL(file);

  const formData = new FormData();
  formData.append("image", file);
  formData.append("smoothness", smoothSlider.value);
  formData.append("brightness", brightnessSlider.value);
  formData.append("contrast", contrastSlider.value);

  try {
    const res = await fetch("/api/enhance", { method:"POST", body:formData });
    if(!res.ok) throw new Error("Enhancement failed");

    const blob = await res.blob();
    enhanced.src = URL.createObjectURL(blob);
    enhanced.style.display="block";
  } catch(e) {
    alert("Enhancement failed: "+e.message);
  } finally {
    loader.style.display="none"; btn.disabled=false;
  }
}
</script>
</body>
</html>
